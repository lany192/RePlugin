apply plugin: 'java'
apply plugin: 'groovy'

repositories {
    jcenter()
    mavenCentral()
    google()
}

buildscript {
    repositories {
        jcenter()
        mavenCentral()
        google()
    }
    dependencies {
//        classpath 'com.android.tools.build:gradle:2.1.0'
        // 将项目发布到JCenter 所需要的jar   添加依赖
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.0'
        classpath 'com.github.dcendents:android-maven-plugin:1.2'
    }
}

group = 'com.qihoo360.replugin'  // 组名

String classPath = ".src.main.groovy.com.qihoo360.replugin.gradle.plugin.AppConstant".replace(".", java.io.File.separator)
String verPath = "${project.projectDir}" + classPath + ".groovy"
String verLine = new File(verPath).filterLine { it =~ /def static final VER =/ }
version = "${verLine.split("\"")[1]}" // 版本
//红色醒目打印显示版本号
java.lang.System.err.println "version=${version}"

sourceSets {
    main {
        groovy {
            srcDirs '../replugin-host-gradle/src/main/groovy/com/qihoo360/replugin/gradle/compat'
        }
    }
}

dependencies {
    implementation 'com.android.tools.build:gradle:7.4.2'
    implementation 'org.json:json:20231013'
    implementation 'org.codehaus.groovy:groovy:3.0.19'
    implementation 'com.squareup:javapoet:1.13.0'
    implementation 'com.android.tools.build:transform-api:1.5.0'
    implementation 'org.javassist:javassist:3.18.2-GA'
    implementation 'commons-io:commons-io:2.5'

    implementation gradleApi()
    implementation localGroovy()

    implementation 'com.google.gradle:osdetector-gradle-plugin:1.2.1'
}

project.ext.RP_ARTIFACT_ID = 'replugin-plugin-gradle'